<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id=":~B{v|z(C@`CnUYS=O3;">distance</variable><variable id="*Ml![6+OJgR;2*]~P~f*">threshold</variable></variables><block type="pxt-on-start" id="*xKbqB@RM2Q$D=Rsm./1" x="0" y="0"><statement name="HANDLER"><block type="variables_set" id="4K7V@jCmC%|=BWRb/?;*"><field name="VAR" id="*Ml![6+OJgR;2*]~P~f*">threshold</field><comment pinned="false" h="80" w="160">Set the threshold distance (e.g., 10 cm)</comment><value name="VALUE"><shadow type="math_number" id="tQVMmo+qAtkwr%O=qGm_"><field name="NUM">10</field></shadow></value><next><block type="radio_set_group" id="$tm?udT3Zyhu-GG|*UVG"><comment pinned="false" h="80" w="160">Set up radio
Set the radio group to 1 (both micro:bits need to be on the same group)</comment><value name="ID"><shadow type="math_number_minmax" id="V%r4I+@XB0r]h%Q@HtMy"><mutation min="0" max="255" precision="0"></mutation><field name="SLIDER">1</field></shadow></value></block></next></block></statement></block><block type="device_forever" id="LNXX!z[dXPegHcN!8w[`" x="327" y="0"><comment pinned="false" h="80" w="160">Set the radio group to 1 (both micro:bits need to be on the same group)</comment><statement name="HANDLER"><block type="device_set_digital_pin" id="]lBX)=.!DzVzVW5TSB^C"><comment pinned="false" h="80" w="160">Trigger the ultrasonic sensor
Ensure trigger is off</comment><value name="name"><shadow type="digital_pin_shadow" id="lFp/-Vp|lsX*ubx[{mBv"><field name="pin">DigitalPin.P0</field></shadow></value><value name="value"><shadow type="math_number_minmax" id="Ir5$psShDJRiqX+)VMW+"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">0</field></shadow></value><next><block type="device_pause" id="jbK^0O59(?%E}Ha$Eq+w"><comment pinned="false" h="80" w="160">Short pause to stabilize</comment><value name="pause"><shadow type="timePicker" id="J@[z]~y~xZS?/QI8%Qf2"><field name="ms">2</field></shadow></value><next><block type="device_set_digital_pin" id="*y#x]y!zi{)]1$s[ETli"><comment pinned="false" h="80" w="160">Send trigger signal</comment><value name="name"><shadow type="digital_pin_shadow" id="mQRNA3xnizN5]V[uSczq"><field name="pin">DigitalPin.P0</field></shadow></value><value name="value"><shadow type="math_number_minmax" id="Mx0n/hx2VY{J3@_.fA_-"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">1</field></shadow></value><next><block type="device_pause" id="1WxC+MRXkur/zso@;)MD"><comment pinned="false" h="80" w="160">Pulse for 10ms</comment><value name="pause"><shadow type="timePicker" id="o*[mU=pUZE;)[_ShAN;c"><field name="ms">10</field></shadow></value><next><block type="device_set_digital_pin" id="YIkESJ0;AiFd.c$_ITG;"><comment pinned="false" h="80" w="160">Stop trigger signal</comment><value name="name"><shadow type="digital_pin_shadow" id="Zh9~brCSMj-I%5r;w;5{"><field name="pin">DigitalPin.P0</field></shadow></value><value name="value"><shadow type="math_number_minmax" id="~NF2TeQS2HM1[n[!yH68"><mutation min="0" max="1" precision="0"></mutation><field name="SLIDER">0</field></shadow></value><next><block type="variables_set" id="kT/fan[T15/Q]a(=QLlX"><field name="VAR" id=":~B{v|z(C@`CnUYS=O3;">distance</field><comment pinned="false" h="80" w="160">Measure the time taken for the echo to return
Distance in cm (pulse duration / 58)</comment><value name="VALUE"><shadow type="math_number" id="Rq18tRHz3!9)Um}:]EHE"><field name="NUM">0</field></shadow><block type="math_arithmetic" id="@jErV^zFI^2;^ZLL!H@g"><field name="OP">DIVIDE</field><value name="A"><shadow type="math_number" id="G=d@(^(Qw},YhuC2n!@;"><field name="NUM">0</field></shadow><block type="pins_pulse_in" id="B-h6p!N6NIv{kq7={M$}"><field name="value">PulseValue.High</field><value name="name"><shadow type="digital_pin_shadow" id="326:nI;a_`)ELW{0;6gJ"><field name="pin">DigitalPin.P1</field></shadow></value></block></value><value name="B"><shadow type="math_number" id="*%B`(C9B}Uor{k!VZMgI"><field name="NUM">58</field></shadow></value></block></value><next><block type="controls_if" id="N9wflw~I_nGQ[jsc+Mz:"><value name="IF0"><shadow type="logic_boolean" id="?hA|}K+Vf@1jIi]Ln(V."><field name="BOOL">TRUE</field></shadow><block type="logic_compare" id=".E}Pg.mBdF.|8fBef$?E"><field name="OP">LT</field><value name="A"><shadow type="math_number" id="3,ozk`O+ui(9!$*u_i9Y"><field name="NUM">0</field></shadow><block type="variables_get" id=":O+ZV9-tu[8S}.g7vKkF"><field name="VAR" id=":~B{v|z(C@`CnUYS=O3;">distance</field></block></value><value name="B"><shadow type="math_number" id=")eKrP2XtkHvJ.+;=o!x9"><field name="NUM">0</field></shadow><block type="variables_get" id="@{;~~N7,A,iX.BnF$V]w"><field name="VAR" id="*Ml![6+OJgR;2*]~P~f*">threshold</field></block></value></block></value><statement name="DO0"><block type="radio_datagram_send_string" id="7;PK]DDMf%.2+e!lN~^U"><comment pinned="false" h="80" w="160">If object is closer than the threshold distance
Send radio message to micro:bit 2</comment><value name="msg"><shadow type="text" id="OIXDX9iiqKo}_i;unhvc"><field name="TEXT">INTRUDER!</field></shadow></value></block></statement><next><block type="device_pause" id="(huBwi+UU0tG!tgM=dmr"><comment pinned="false" h="80" w="160">Pause before the next measurement</comment><value name="pause"><shadow type="timePicker" id="_iP,!PDNrL0Dv3#W+31U"><field name="ms">100</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement></block></xml>